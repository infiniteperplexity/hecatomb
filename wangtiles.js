
let wangtiles = {
     t00000000: {
          tiles: [
               `
               00000000
               00000000
               00000000
               00000000
               00000000
               00000000
               00000000
               00000000
               `,
               `
               00000000
               00000000
               00011000
               00111100
               00111100
               00011000
               00000000
               00000000
               `
          ]
     },
     t00000001: {
          tiles: [
               `
               00000000
               00000000
               11100000
               11110000
               11110000
               11100000
               00000000
               00000000
               `
          ]
     },
     t00000011: {
          tiles: [
               `
               00000000
               00000000
               11100000
               11110000
               11110000
               11110000
               11110000
               11100000
               `
          ]
     },
     t00000101: {
          tiles: [
               `
               00000000
               00000000
               11100000
               11110000
               11111000
               00111100
               00011100
               00011100
               `
          ]
     },
     t00000111: {
          tiles: [
               `
               11100000
               11100000
               11110000
               11110000
               11110000
               11110000
               11100000
               11100000
               `
          ]
     },
     t00001001: {
          tiles: [
               `
               00000000
               00000000
               11000000
               11100000
               11100001
               11000111
               00000111
               00001111
               `,
               `
               00000000
               00000000
               11000000
               11111000
               11111111
               11111111
               00011111
               00001111
               `
          ]
     },
     t00001011: {
          tiles: [
               `
               00000000
               00000000
               11000000
               11100000
               11100001
               11100111
               11000111
               11100111
               `,
               `
               00000000
               00000000
               11000000
               11111111
               11111111
               11111111
               11100111
               11100111
               `
          ]
     },
     t00001111: {
          tiles: [
               `
               00000000
               00000000
               11000000
               11100000
               11111000
               11111110
               11111111
               11111111
               `
          ]
     },
     t00010001: {
          tiles: [
               `
               00000000
               00000000
               10000001
               11000011
               11000011
               10000001
               00000000
               00000000
               `,
               `
               00000000
               00000000
               11000011
               11111111
               11111111
               11000011
               00000000
               00000000
               `
          ]
     },
     t00010011: {
          tiles: [
               `
               00000000
               00000000
               10000001
               11000011
               11000011
               10000111
               00000111
               00000111
               `,
               `
               00000000
               00000000
               11100111
               11111111
               11111111
               10011111
               00000111
               00000111
               `
          ]
     },
     t00010101: {
          tiles: [
               `
               00000000
               00000000
               10000011
               11000111
               11000111
               10001110
               00011110
               00111100
               `
          ]
     },
     t00010110: {
          tiles: [
               `
               00000000
               00000000
               00000001
               00000111
               00011111
               11111111
               11111110
               11111100
               `
          ]
     },
     t00011011: {
          tiles: [
               `
               00000000
               00000000
               10000001
               11000011
               11000011
               11100111
               11100111
               11100111
               `,
               `
               00000000
               00000000
               11000011
               11111111
               11111111
               11111111
               11100111
               11100111
               `
          ]
     },
     t00011101: {
          tiles: [
               `
               00000000
               00000000
               10000001
               11000011
               11000111
               10001111
               00011111
               00111111
               `,
               `
               00000000
               00000000
               11000011
               11111111
               11111111
               01111111
               00111111
               00011111
               `
          ]
     },
     t00011111: {
          tiles: [
               `
               00000000
               00000000
               11000011
               11111111
               11111111
               11111111
               11111111
               11111111
               `,
               `
               00000000
               00000000
               11000011
               11000011
               11000011
               11000011
               11100111
               11111111
               `
          ]
     },
     t00100111: {
          tiles: [
               `
               00000111
               00000111
               10000011
               11000000
               11000000
               11100000
               11111000
               11111100
               `,
               `
               00000111
               00000111
               00011111
               11111110
               11111100
               11111000
               11111000
               11111100
               `
          ]
     },
     t00101011: {
          tiles: [
               `
               00000111
               00000111
               10000011
               11000000
               11000000
               11100001
               11100011
               11100111
               `,
               `
               00000111
               00000011
               10000000
               11000000
               11111110
               11111111
               11100111
               11000011
               `,
               `
               00000111
               00001111
               00111110
               11111100
               11111100
               11111110
               11100111
               11000011
               `
          ]
     },
     t00101101: {
          tiles: [
               `
               00000111
               00000111
               10000011
               11000000
               11000000
               10000111
               00011111
               00111111
               `,
               `
               00000111
               00000111
               10000011
               11000000
               11110000
               01111111
               00111111
               00011111
               `,
               `
               00000111
               00001111
               11111111
               11111000
               11000000
               10000111
               00011111
               00111111
               `,
               `
               00000111
               00011111
               11111110
               11111100
               11111100
               11111110
               00111111
               00111111
               `
          ]
     },
     t00101111: {
          tiles: [
               `
               00000111
               00000111
               10000011
               11000000
               11100000
               11111100
               11111111
               11111111
               `,
               `
               00000111
               00011111
               11111110
               11111100
               11111100
               11111110
               11111111
               11111111
               `
          ]
     },
     t00110011: {
          tiles: [
               `
               00000111
               00000111
               10000111
               11000011
               11000011
               11100001
               11100000
               11100000
               `,
               `
               00000111
               00000111
               00011111
               11111111
               11111111
               11111100
               11110000
               11100000
               `
          ]
     },
     t00110111: {
          tiles: [
               `
               00000111
               00000111
               10000111
               11000011
               11000011
               11110001
               11111000
               11111100
               `,
               `
               00000111
               00000111
               00011111
               11111111
               11111111
               11111110
               11111100
               11111000
               `
          ]
     },
     t00111111: {
          tiles: [
               `
               00000011
               00000011
               10000011
               11000111
               11111111
               11111111
               11111111
               11111111
               `
          ]
     },
     t01001001: {
          tiles: [
               `
               00111100
               00011000
               10000000
               11000000
               11000000
               10000000
               00000001
               00000011
               `,
               `
               00111100
               01111000
               11100000
               11000000
               11000000
               10000000
               00000001
               00000011
               `,
               `
               00111100
               00011000
               10000000
               11000000
               11110000
               11111100
               00011111
               00000011
               `,
               `
               00111100
               00011100
               10001100
               11001110
               11001110
               10001110
               00000111
               00000011
               `,
               `
               00111100
               01111100
               11111100
               11111110
               11111110
               11001110
               00000111
               00000011
               `
          ]
     },
     t00000010: {
          tiles: [
               `
               00000000
               00000000
               00000000
               00000000
               00000000
               00000000
               10000000
               11000000
               `
          ]
     },
     t00111011: {
          tiles: []
     },
     t00101010: {
          tiles: [
               `
               00000011
               00000001
               00000000
               00000000
               00000000
               00000000
               10000001
               11000011
               `
          ]
     },
     t00111000: {
          tiles: [
               `
               00000011
               00000111
               00000111
               00000011
               00000011
               00000111
               00000111
               00000011
               `
          ]
     },
     t00111110: {
          tiles: [
               `
               00000111
               00000111
               00000011
               00000011
               00000111
               00011111
               11111111
               11111111
               `
          ]
     },
     t00001010: {
          tiles: [
               `
               00000000
               00000000
               10000000
               11000000
               11000000
               10000000
               00011000
               00111100
               `
          ]
     },
     t01001110: {
          tiles: [
               `
               00111100
               00011000
               00000000
               00000000
               00000000
               00000000
               11000011
               11111111
               `
          ]
     },
     t00100010: {
          tiles: [
               `
               00000011
               00000001
               10000000
               11000000
               11000000
               10000000
               00000000
               00000000
               `
          ]
     },
     t00111010: {
          tiles: [
               `
               00000011
               00000001
               10000001
               11000011
               11000011
               10000001
               00000001
               00000011
               `
          ]
     },
     t00110010: {
          tiles: [
               `
               00000011
               00000111
               10000111
               11000111
               11000011
               10000001
               00000000
               00000000
               `
          ]
     },
     t01001010: {
          tiles: [
               `
               00111100
               00011000
               00000000
               00000000
               00000000
               00000000
               10000001
               11000011
               `
          ],
     },
     t01100011: {
          tiles: [
               `
               00011111
               00000011
               10000000
               11000000
               11100000
               11100000
               11000000
               11000000
               `
          ]
     },
     t01101011: {
          tiles: [
               `
               00111111
               00001111
               10000000
               11000000
               11100000
               11100000
               11000001
               11000011
               `
          ]
     },
     t01001101: {
          tiles: [
               `
               00111100
               00011000
               10000000
               11000000
               11000000
               10000000
               00000111
               00011111
               `,
               `
               00111100
               01111000
               11100000
               11000000
               11000000
               10000000
               00000111
               00011111
               `,
               `
               00111100
               00011000
               10000000
               11000000
               11000000
               11110000
               01111111
               00111111
               `,
               `
               00111100
               00011100
               10001110
               11001110
               11001100
               10001100
               00011111
               00011111
               `,
               `
               00111100
               01111000
               11110000
               11100000
               11100000
               11111000
               01111111
               00111111
               `
          ]
     },
     t01010101: {
          tiles: [
               `
               00111100
               00011000
               10000001
               11000011
               11000011
               10000001
               00011000
               00111100
               `,
               `
               00111100
               00011000
               10011001
               11111111
               11111111
               10011001
               00011000
               00111100
               `
          ]
     },
     t01011011: {
          tiles: [
               `
               00111100
               00011000
               10000001
               11000011
               11000011
               11000011
               11100111
               11100111
               `,
               `
               00111100
               00011000
               10000001
               11000011
               11111111
               11111111
               11100111
               11000011
               `,
               `
               00111100
               00011110
               10001111
               11000111
               11100111
               11100111
               11100111
               11100111
               `,
               `
               00111100
               01111000
               11100001
               11100011
               11100111
               11100111
               11100111
               11100111
               `,
               `
               00111100
               01111110
               11111111
               11111111
               11111111
               11111111
               11100111
               11000011
               `
          ]
     },
     t01011101: {
          tiles: [
               `
               00111100
               00011000
               10000001
               11000011
               11000011
               10000111
               00001111
               00011111
               `,
               `
               00111100
               00011000
               10000001
               11000011
               11100111
               11111111
               01111111
               00111111
               `,
               `
               00111100
               01111000
               11100001
               11000011
               11000011
               10000111
               00001111
               00011111
               `,
               `
               00111100
               01111110
               11111111
               11111111
               11111111
               11111111
               01111111
               00111111
               `
          ]
     },
     t01011110: {
          tiles: [
               `
               00111100
               00011000
               00000001
               00000011
               00000011
               00111111
               11111111
               11111111
               `,
               `
               00111100
               00011110
               00001111
               00001111
               00001111
               00111111
               11111111
               11111111
               `
          ]
     },
     t01011111: {
          tiles: [
               `
               00111100
               00011000
               10000001
               11000011
               11111111
               11111111
               11111111
               11111111
               `,
               `
               00111100
               01111110
               11111111
               11111111
               11111111
               11111111
               11111111
               11111111
               `,
               `
               00111100
               00011000
               10000001
               11000011
               11000011
               11000011
               11100111
               11111111
               `
          ]
     },
     t01101111: {
          tiles: [
               `
               00011111
               00000111
               00000000
               10000000
               11000000
               11111000
               11111111
               11111111
               `,
               `
               00011111
               00011111
               00111100
               11111000
               11111000
               11111100
               11111111
               11111111
               `
          ]
     },
     t01110111: {
          tiles: [
               `
               00111111
               00011111
               10001111
               11000111
               11100011
               11110001
               11111000
               11111100
               `,
               `
               00111111
               00011111
               10011111
               11111111
               11111111
               11111001
               11111000
               11111100
               `
          ]
     },
     t01111111: {
          tiles: [
               `
               00011111
               00011111
               00111111
               11111111
               11111111
               11111111
               11111111
               11111111
               `,
               `
               00011111
               00001111
               00000111
               10000011
               11000011
               11100111
               11111111
               11111111
               `
          ]
     },
     t10101010: {
          tiles: [
               `
               11000011
               10000001
               00000000
               00000000
               00000000
               00000000
               10000001
               11000011
               `
          ]
     },
     t10101011: {
          tiles: [
               `
               11000011
               10000001
               10000000
               11000000
               11000000
               10000000
               10000001
               11000011
               `
          ]
     },
     t10101111: {
          tiles: [
               `
               11000011
               11100111
               11111110
               11111100
               11111100
               11111110
               11111111
               11111111
               `,
               `
               11000011
               11100001
               11100000
               11110000
               11111000
               11111110
               11111111
               11111111
               `
          ]
     },
     t10111011: {
          tiles: [
               `
               11000011
               11100111
               11111111
               11111111
               11111111
               11111111
               11100111
               11000011
               `,
               `
               11000011
               11100111
               11100111
               11000011
               11000011
               11100111
               11100111
               11000011
               `
          ]
     },
     t11111110: {
          tiles: [
               `
               11111111
               11111111
               01111111
               00111111
               00111111
               01111111
               11111111
               11111111
               `
          ]
     },
     t11111111: {
          tiles: [
               `
               11111111
               11111111
               11111111
               11111111
               11111111
               11111111
               11111111
               11111111
               `
          ]
     }
};


function template2array(tile) {
     tile = tile.split("\n");
     tile.pop();
     tile.shift();
     tile = tile.map(s=>s.trim());
     grid = [];
     for (let i=0; i<8; i++) {
          grid.push([]);
          for (let j=0; j<8; j++) {
               grid[i][j] = parseInt(tile[i][j]);
          }
     }
     return grid;
}

function reverseKey(key) {
     key = key.substr(1,8);
     key = key.substr(0,1)+key.substr(1,7).split("").reverse().join("");
     key = "t"+key;
     return key;
}

function rotateKey(key) {
     let one = key.substr(1,2);
     let two = key.substr(3,7);
     return "t"+two+one;
}

function reverseGrid(grid) {
     sq = [];
     for (let i=0; i<8; i++) {
          sq.push([]);
          for (let j=0; j<8; j++) {
               sq[i][j] = grid[j][i];
          }
     }
     return sq;
}

function rotateGrid(grid) {
     sq = [];
     for (let i=0; i<8; i++) {
          sq.push([]);
          for (let j=0; j<8; j++) {
               sq[i][j] = grid[j][7-i];
          }
     }
     return sq;
}

// test for completeness and duplication
// let newtiles = {};
// for (let key in wangtiles) {
//      newtiles[key] = "dummy";
//      let k = key;
//      for (let i=0; i<4; i++) {
//           let rev = reverseKey(k);
//           if (rev in wangtiles && rev!==key && rev!==k) {
//                console.log("duplicate",key,rev);
//           }
//           if (!(rev in wangtiles)) {
//                newtiles[rev] = "dummy";
//           }
//           let rot = rotateKey(k);
//           if (rot in wangtiles && rot!==key) {
//                console.log("duplicate",key,rot);
//           }
//           if (!(rot in wangtiles)) {
//                newtiles[rot] = "dummy";
//           }
//           k = rot;
//      }
// }
// console.log(Object.keys(wangtiles).length);
// console.log(Object.keys(newtiles).length);
// notfound = {};
// for (let i=0; i<1000; i++) {
//      let key = "t";
//      for (let j=0; j<8; j++) {
//           key = key+ROT.RNG.getUniformInt(0,1);
//      }
//      if (!(key in newtiles)) {
//           notfound[key] = "dummy";
//      }
// }
// console.log(Object.keys(notfound).sort());

let keys = Object.keys(wangtiles);
for (let key of keys) {
     if (key.length!==9) {
          console.log(key);
     }
     let tiles = wangtiles[key].tiles;
     // derive arrays from strings
     wangtiles[key].squares = [];
     for (let tile of tiles) {
          let grid = template2array(tile);
          wangtiles[key].squares.push(grid);
     }
     for (let i=0; i<4; i++) {
          let revkey = reverseKey(key);
          if (revkey.length!==9) {
               console.log(revkey);
          }
          if (wangtiles[revkey]===undefined) {
               wangtiles[revkey] = {squares: []};
               for (square of wangtiles[key].squares) {
                    wangtiles[revkey].squares.push(reverseGrid(square));
               }
          }
          rotkey = rotateKey(key);
          if (wangtiles[rotkey]===undefined) {
               wangtiles[rotkey] = {squares: []};
               for (square of wangtiles[key].squares) {
                    wangtiles[rotkey].squares.push(rotateGrid(square));
               }
          }
          key = rotkey;
     }    
}
